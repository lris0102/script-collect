# 安全工具集

本工具集包括以下功能：

1. **Nginx 日志安全分析器**
2. **内网资产扫描器**
3. **资产采集工具**

## 功能介绍

### 1. Nginx 日志安全分析器

**功能**：
- SQL 注入攻击检测
- 常见扫描工具和黑客工具检测
- 敏感文件访问检测
- Webshell 行为分析
- 提供 IP 地址统计和日志分析报告

**使用方法**：
- 配置 Nginx 日志目录（默认 `/var/log/nginx/`）。
- 通过执行脚本分析日志，输出结果到 `/tmp/logs/` 目录。
- 运行脚本：
    ```bash
    chmod +x nginx_log_security_analyzer.sh
    ./nginx_log_security_analyzer.sh
    ```

### 2. 内网资产扫描器

**功能**：
- 扫描整个内网网段，发现在线主机
- 扫描开放端口，并识别常见服务（如 HTTP、SSH、MySQL 等）
- 通过 SSH 登录主机，检查系统日志，判断是否存在入侵行为

**使用方法**：
- 修改需要扫描的子网范围。
- 运行 Go 代码进行扫描：
    ```bash
    go build -o network_scanner
    ./network_scanner
    ```
- 该工具会扫描内网所有主机，输出开放端口、服务类型及入侵检测结果。

### 3. 资产采集工具

**功能**：
- 自动从 CMDB 获取服务器和应用的资产信息，并将其存储到图数据库（Neo4j）中
- 支持多对多关系：一个服务器可以运行多个应用，一个应用可以部署在多个服务器上
- 生成服务器与应用的关联关系，便于资产的可视化管理与分析

**使用方法**：
- 配置 Neo4j 数据库连接信息（如 URI、用户名、密码），并确保已安装 Neo4j 数据库。
- 运行资产采集工具，将资产信息同步到 Neo4j：
    ```bash
    go build -o asset_collector
    ./asset_collector
    ```
- 或者通过 Docker 容器运行所有服务：
    ```bash
    docker-compose up --build
    ```
- 资产采集完成后，可以通过 Neo4j 图数据库界面查看资产的拓扑结构和关系。

## 适用场景

- 个人学习和实验环境，用于提升日志分析、内网资产扫描和资产管理的安全技能
- 非生产环境中的初步分析，快速发现潜在的安全问题并理解资产关系

## 注意事项

- **Nginx 日志安全分析器**：建议用于 ELK 或 Splunk 之前的初步分析
- **内网资产扫描器**：适用于内网测试环境，不建议用于大规模或生产网络
- **资产采集工具**：适用于学习和演示环境，帮助用户理解服务器和应用系统之间的关系

## 支持容器运行

本工具集支持使用 Docker Compose 进行容器化部署，执行以下命令启动所有服务：

```bash
docker-compose up --build
